import{s as yt,y as Nt,R as wt,e as Ct}from"./index.df3bf71b.js";var M=Uint8Array,X=Uint16Array,tt=Uint32Array,nt=new M([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),st=new M([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),It=new M([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rt=function(e,t){for(var n=new X(31),s=0;s<31;++s)n[s]=t+=1<<e[s-1];for(var r=new tt(n[30]),s=1;s<30;++s)for(var o=n[s];o<n[s+1];++o)r[o]=o-n[s]<<5|s;return[n,r]},ot=rt(nt,2),at=ot[0],At=ot[1];at[28]=258,At[258]=28;var bt=rt(st,0),Pt=bt[0],Ce=new X(32768);for(var g=0;g<32768;++g){var B=(g&43690)>>>1|(g&21845)<<1;B=(B&52428)>>>2|(B&13107)<<2,B=(B&61680)>>>4|(B&3855)<<4,Ce[g]=((B&65280)>>>8|(B&255)<<8)>>>1}var re=function(e,t,n){for(var s=e.length,r=0,o=new X(t);r<s;++r)e[r]&&++o[e[r]-1];var a=new X(t);for(r=0;r<t;++r)a[r]=a[r-1]+o[r-1]<<1;var c;if(n){c=new X(1<<t);var i=15-t;for(r=0;r<s;++r)if(e[r])for(var l=r<<4|e[r],d=t-e[r],m=a[e[r]-1]++<<d,h=m|(1<<d)-1;m<=h;++m)c[Ce[m]>>>i]=l}else for(c=new X(s),r=0;r<s;++r)e[r]&&(c[r]=Ce[a[e[r]-1]++]>>>15-e[r]);return c},fe=new M(288);for(var g=0;g<144;++g)fe[g]=8;for(var g=144;g<256;++g)fe[g]=9;for(var g=256;g<280;++g)fe[g]=7;for(var g=280;g<288;++g)fe[g]=8;var it=new M(32);for(var g=0;g<32;++g)it[g]=5;var xt=re(fe,9,1),Ot=re(it,5,1),ye=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},H=function(e,t,n){var s=t/8|0;return(e[s]|e[s+1]<<8)>>(t&7)&n},Ne=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},kt=function(e){return(e+7)/8|0},Mt=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var s=new(e.BYTES_PER_ELEMENT==2?X:e.BYTES_PER_ELEMENT==4?tt:M)(n-t);return s.set(e.subarray(t,n)),s},Ft=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],L=function(e,t,n){var s=new Error(t||Ft[e]);if(s.code=e,Error.captureStackTrace&&Error.captureStackTrace(s,L),!n)throw s;return s},Me=function(e,t,n){var s=e.length;if(!s||n&&n.f&&!n.l)return t||new M(0);var r=!t||n,o=!n||n.i;n||(n={}),t||(t=new M(s*3));var a=function(Je){var $e=t.length;if(Je>$e){var Xe=new M(Math.max($e*2,Je));Xe.set(t),t=Xe}},c=n.f||0,i=n.p||0,l=n.b||0,d=n.l,m=n.d,h=n.m,p=n.n,v=s*8;do{if(!d){c=H(e,i,1);var b=H(e,i+1,3);if(i+=3,b)if(b==1)d=xt,m=Ot,h=9,p=5;else if(b==2){var T=H(e,i,31)+257,U=H(e,i+10,15)+4,ue=T+H(e,i+5,31)+1;i+=14;for(var te=new M(ue),Te=new M(19),F=0;F<U;++F)Te[It[F]]=H(e,i+F*3,7);i+=U*3;for(var We=ye(Te),Tt=(1<<We)-1,gt=re(Te,We,1),F=0;F<ue;){var ze=gt[H(e,i,Tt)];i+=ze&15;var _=ze>>>4;if(_<16)te[F++]=_;else{var q=0,de=0;for(_==16?(de=3+H(e,i,3),i+=2,q=te[F-1]):_==17?(de=3+H(e,i,7),i+=3):_==18&&(de=11+H(e,i,127),i+=7);de--;)te[F++]=q}}var De=te.subarray(0,T),D=te.subarray(T);h=ye(De),p=ye(D),d=re(De,h,1),m=re(D,p,1)}else L(1);else{var _=kt(i)+4,C=e[_-4]|e[_-3]<<8,k=_+C;if(k>s){o&&L(0);break}r&&a(l+C),t.set(e.subarray(_,k),l),n.b=l+=C,n.p=i=k*8,n.f=c;continue}if(i>v){o&&L(0);break}}r&&a(l+131072);for(var _t=(1<<h)-1,Rt=(1<<p)-1,ge=i;;ge=i){var q=d[Ne(e,i)&_t],G=q>>>4;if(i+=q&15,i>v){o&&L(0);break}if(q||L(2),G<256)t[l++]=G;else if(G==256){ge=i,d=null;break}else{var Be=G-254;if(G>264){var F=G-257,ne=nt[F];Be=H(e,i,(1<<ne)-1)+at[F],i+=ne}var _e=m[Ne(e,i)&Rt],Re=_e>>>4;_e||L(3),i+=_e&15;var D=Pt[Re];if(Re>3){var ne=st[Re];D+=Ne(e,i)&(1<<ne)-1,i+=ne}if(i>v){o&&L(0);break}r&&a(l+131072);for(var Ke=l+Be;l<Ke;l+=4)t[l]=t[l-D],t[l+1]=t[l+1-D],t[l+2]=t[l+2-D],t[l+3]=t[l+3-D];l=Ke}}n.l=d,n.p=ge,n.b=l,n.f=c,d&&(c=1,n.m=h,n.d=m,n.n=p)}while(!c);return l==t.length?t:Mt(t,0,l)},Ht=new M(0),Lt=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&L(6,"invalid gzip data");var t=e[3],n=10;t&4&&(n+=e[10]|(e[11]<<8)+2);for(var s=(t>>3&1)+(t>>4&1);s>0;s-=!e[n++]);return n+(t&2)},Ut=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},Wt=function(e){((e[0]&15)!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)&&L(6,"invalid zlib data"),e[1]&32&&L(6,"invalid zlib data: preset dictionaries not supported")};function zt(e,t){return Me(e,t)}function Dt(e,t){return Me(e.subarray(Lt(e),-8),t||new M(Ut(e)))}function Bt(e,t){return Me((Wt(e),e.subarray(2,-4)),t)}function Kt(e,t){return e[0]==31&&e[1]==139&&e[2]==8?Dt(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?zt(e,t):Bt(e,t)}var Jt=typeof TextDecoder!="undefined"&&new TextDecoder,$t=0;try{Jt.decode(Ht,{stream:!0}),$t=1}catch{}var Fe=(e=>(e[e.EN=0]="EN",e[e.FR=1]="FR",e))(Fe||{});const Xt={1:"P E A N U T  3000",2:`Copyright  } 1990 Peanut Computer, Inc.
All rights reserved.

CDOS Version 5.01`,3:"2",4:"3",5:".",6:"A",7:"@",8:"PEANUT 3000",10:"R",11:"U",12:"N",13:"P",14:"R",15:"O",16:"J",17:"E",18:"C",19:"T",20:"Shield 9A.5f Ok",21:"Flux % 5.0177 Ok",22:"CDI Vector ok",23:" %%%ddd ok",24:"Race-Track ok",25:"SYNCHROTRON",26:`E: 23%
g: .005

RK: 77.2L

opt: g+

 Shield:
1: OFF
2: ON
3: ON

P~: 1
`,27:"ON",28:"-",33:"|",34:"--- Theoretical study ---",35:" THE EXPERIMENT WILL BEGIN IN    SECONDS",36:"  20",37:"  19",38:"  18",39:"  4",40:"  3",41:"  2",42:"  1",43:"  0",44:"L E T ' S   G O",49:`- Phase 0:
INJECTION of particles
into synchrotron`,50:`- Phase 1:
Particle ACCELERATION.`,51:`- Phase 2:
EJECTION of particles
on the shield.`,52:"A  N  A  L  Y  S  I  S",53:`- RESULT:
Probability of creating:
 ANTIMATTER: 91.V %
 NEUTRINO 27:  0.04 %
 NEUTRINO 424: 18 %
`,54:"   Practical verification Y/N ?",55:"SURE ?",56:`MODIFICATION OF PARAMETERS
RELATING TO PARTICLE
ACCELERATOR (SYNCHROTRON).`,57:"       RUN EXPERIMENT ?",60:"t---t",61:"000 ~",62:".20x14dd",63:"gj5r5r",64:"tilgor 25%",65:"12% 33% checked",66:"D=4.2158005584",67:"d=10.00001",68:"+",69:"*",70:"% 304",71:"gurgle 21",72:"{{{{",73:"Delphine Software",74:"By Eric Chahi",75:"  5",76:"  17",300:"0",301:"1",302:"2",303:"3",304:"4",305:"5",306:"6",307:"7",308:"8",309:"9",310:"A",311:"B",312:"C",313:"D",314:"E",315:"F",316:"        ACCESS CODE:",317:"PRESS BUTTON OR RETURN TO CONTINUE",318:"   ENTER ACCESS CODE",319:"   INVALID PASSWORD !",320:"ANNULER",321:`      INSERT DISK ?








PRESS ANY KEY TO CONTINUE`,322:` SELECT SYMBOLS CORRESPONDING TO
 THE POSITION
 ON THE CODE WHEEL`,323:"    LOADING...",324:"              ERROR",350:"LDKD",351:"HTDC",352:"CLLD",353:"FXLC",354:"KRFK",355:"XDDJ",356:"LBKG",357:"KLFB",358:"TTCT",359:"DDRX",360:"TBHK",361:"BRTD",362:"CKJL",363:"LFCK",364:"BFLX",365:"XJRT",366:"HRTB",367:"HBHK",368:"JCGB",369:"HHFL",370:"TFBB",371:"TXHF",372:"JHJL",385:" BY",386:"ERIC CHAHI",387:"         MUSIC AND SOUND EFFECTS",388:" ",389:"JEAN-FRANCOIS FREITAS",390:"IBM PC VERSION",391:"      BY",392:" DANIEL MORAIS",395:"       THEN PRESS FIRE",396:" PUT THE PADDLE ON THE UPPER LEFT CORNER",397:"PUT THE PADDLE IN CENTRAL POSITION",398:"PUT THE PADDLE ON THE LOWER RIGHT CORNER",400:"Good evening professor.",401:`I see you have driven here in your
Ferrari.`,402:"IDENTIFICATION",403:`AU BOULOT !!!
`,404:`Y
`,500:"Over Two Years in the Making",501:`   A New, State
of the Art, Polygon
  Graphics System`,502:`   Comes to the
Computer With Full
 Screen Graphics`,503:`While conducting a nuclear fission
experiment at your local
particle accelerator ...`,504:`Nature decides to put a little
    extra spin on the ball`,505:"And sends you ...",506:`     Out of this World
A Cinematic Action Adventure
 from Interplay Productions
                    
       By Eric CHAHI      

  IBM version : D.MORAIS
`,600:"      Designed by ..... Eric Chahi",601:"    Programmed by...... Eric Chahi",602:"      Artwork ......... Eric Chahi",603:"Music by ........ Jean-francois Freitas",604:"            Sound effects",605:`        Jean-Francois Freitas
             Eric Chahi`,611:"              Thanks To",612:`           Jesus Martinez

          Daniel Morais

        Frederic Savoir

      Cecile Chahi

    Philippe Delamarre

  Philippe Ulrich

Sebastien Berthet

Pierre Gousseau`,613:"Now Go Out Of This World"},je={34:"--- Etude theorique ---",35:" L'EXPERIENCE DEBUTERA DANS    SECONDES.",36:"20",37:"19",38:"18",39:"4",40:"3",41:"2",42:"1",43:"0",49:`- Phase 0:
INJECTION des particules
dans le synchrotron`,50:`- Phase 1:
ACCELERATION des particules.`,51:`- Phase 2:
EJECTION des particules
sur le bouclier.`,52:"A  N  A  L  Y  S  E",53:`- RESULTAT:
Probabilites de creer de:
 ANTI-MATIERE: 91.V %
 NEUTRINO 27:  0.04 %
 NEUTRINO 424: 18 %
`,54:"Verification par la pratique O/N ?",55:"SUR ?",56:`MODIFICATION DES PARAMETRES
RELATIFS A L'ACCELERATEUR
DE PARTICULES (SYNCHROTRON).`,57:"SIMULATION DE L'EXPERIENCE ?",75:"5",76:"17",316:"       CODE D'ACCES:",317:"PRESSEZ LE BOUTON POUR CONTINUER",318:"   ENTRER LE CODE D'ACCES",319:"MOT DE PASSE INVALIDE !",321:`     INSEREZ LA DISQUETTE ?








PRESSEZ UNE TOUCHE POUR CONTINUER`,322:`SELECTIONNER LES SYMBOLES CORRESPONDANTS
A LA POSITION
DE LA ROUE DE PROTECTION`,323:"CHARGEMENT...",324:"             ERREUR",385:"PAR",387:"          MUSIQUES ET BRUITAGES",388:"DE",390:"VERSION IBM PC",391:"      PAR",395:"PUIS PRESSER LE BOUTON",396:"POSITIONNER LE JOYSTICK EN HAUT A GAUCHE",397:" POSITIONNER LE JOYSTICK AU CENTRE",398:" POSITIONNER LE JOYSTICK EN BAS A DROITE",400:"Bonsoir professeur.",401:`Je vois que Monsieur a pris
sa Ferrari.`,404:"O",600:"       Conception ..... Eric Chahi",601:"    Programmation ..... Eric Chahi",602:"     Graphismes ....... Eric Chahi",603:"Musique de ...... Jean-francois Freitas",604:"              Bruitages",611:"               Merci a",613:"Now Go Back To Another Earth"},jt=[0,0,0,0,0,0,0,0,16,16,16,16,16,0,16,0,40,40,0,0,0,0,0,0,0,36,126,36,36,126,36,0,8,62,72,60,18,124,16,0,66,164,72,16,36,74,132,0,96,144,144,112,138,132,122,0,8,8,16,0,0,0,0,0,6,8,16,16,16,8,6,0,192,32,16,16,16,32,192,0,0,68,40,16,40,68,0,0,0,16,16,124,16,16,0,0,0,0,0,0,0,16,16,32,0,0,0,124,0,0,0,0,0,0,0,0,16,40,16,0,0,4,8,16,32,64,0,0,120,132,140,148,164,196,120,0,16,48,80,16,16,16,124,0,120,132,4,8,48,64,252,0,120,132,4,56,4,132,120,0,8,24,40,72,252,8,8,0,252,128,248,4,4,132,120,0,56,64,128,248,132,132,120,0,252,4,4,8,16,32,64,0,120,132,132,120,132,132,120,0,120,132,132,124,4,8,112,0,0,24,24,0,0,24,24,0,0,0,24,24,0,16,16,96,4,8,16,32,16,8,4,0,0,0,254,0,0,254,0,0,32,16,8,4,8,16,32,0,124,130,2,12,16,0,16,0,48,24,12,12,12,24,48,0,120,132,132,252,132,132,132,0,248,132,132,248,132,132,248,0,120,132,128,128,128,132,120,0,248,132,132,132,132,132,248,0,124,64,64,120,64,64,124,0,252,128,128,240,128,128,128,0,124,128,128,140,132,132,124,0,132,132,132,252,132,132,132,0,124,16,16,16,16,16,124,0,4,4,4,4,132,132,120,0,140,144,160,224,144,136,132,0,128,128,128,128,128,128,252,0,130,198,170,146,130,130,130,0,132,196,164,148,140,132,132,0,120,132,132,132,132,132,120,0,248,132,132,248,128,128,128,0,120,132,132,132,132,140,124,3,248,132,132,248,144,136,132,0,120,132,128,120,4,132,120,0,124,16,16,16,16,16,16,0,132,132,132,132,132,132,120,0,132,132,132,132,132,72,48,0,130,130,130,130,146,170,198,0,130,68,40,16,40,68,130,0,130,68,40,16,16,16,16,0,252,4,8,16,32,64,252,0,60,48,48,48,48,48,60,0,60,48,48,48,48,48,60,0,60,48,48,48,48,48,60,0,60,48,48,48,48,48,60,0,0,0,0,0,0,0,0,254,60,48,48,48,48,48,60,0,0,0,56,4,60,68,60,0,64,64,120,68,68,68,120,0,0,0,60,64,64,64,60,0,4,4,60,68,68,68,60,0,0,0,56,68,124,64,60,0,56,68,64,96,64,64,64,0,0,0,60,68,68,60,4,120,64,64,88,100,68,68,68,0,16,0,16,16,16,16,16,0,2,0,2,2,2,2,66,60,64,64,70,72,112,72,70,0,16,16,16,16,16,16,16,0,0,0,236,146,146,146,146,0,0,0,120,68,68,68,68,0,0,0,56,68,68,68,56,0,0,0,120,68,68,120,64,64,0,0,60,68,68,60,4,4,0,0,76,112,64,64,64,0,0,0,60,64,56,4,120,0,16,16,60,16,16,16,12,0,0,0,68,68,68,68,120,0,0,0,68,68,68,40,16,0,0,0,130,130,146,170,198,0,0,0,68,40,16,40,68,0,0,0,66,34,36,24,8,48,0,0,124,8,16,32,124,0,96,144,32,64,240,0,0,0,254,254,254,254,254,254,254,0,56,68,186,162,186,68,56,0,56,68,130,130,68,40,238,0,85,170,85,170,85,170,85,170];function Vt(e){switch(e){default:return new Promise(function(t,n){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+e)))})}}function qt(e){switch(e){default:return new Promise(function(t,n){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+e)))})}}let lt=!0,Ie,P;var ie=(e=>(e[e.PROTECTION=16e3]="PROTECTION",e[e.INTRODUCTION=16001]="INTRODUCTION",e[e.WATER=16002]="WATER",e[e.JAIL=16003]="JAIL",e[e.CITY=16004]="CITY",e[e.ARENA=16005]="ARENA",e[e.BATHS=16006]="BATHS",e[e.FINAL=16007]="FINAL",e[e.CODE=16008]="CODE",e[e.CODE2=16009]="CODE2",e))(ie||{});const Gt="ootw",Yt="ootw-demo";(async function(){try{const t=await qt(`../../../data/${Gt}.js`);console.log("loaded ootw.js"),lt=!1,Ie={[16e3]:[t.data14,t.size14,t.data15,t.size15,t.data16,t.size16,null,null],[16001]:[t.data17,t.size17,t.data18,t.size18,t.data19,t.size19,null,null],[16002]:[t.data1a,t.size1a,t.data1b,t.size1b,t.data1c,t.size1c,t.data11,t.size11],[16003]:[t.data1d,t.size1d,t.data1e,t.size1e,t.data1f,t.size1f,t.data11,t.size11],[16004]:[t.data20,t.size20,t.data21,t.size21,t.data22,t.size22,t.data11,t.size11],[16005]:[t.data23,t.size23,t.data24,t.size24,t.data25,t.size25,t.data11,t.size11],[16006]:[t.data26,t.size26,t.data27,t.size27,t.data28,t.size28,t.data11,t.size11],[16007]:[t.data29,t.size29,t.data2a,t.size2a,t.data2b,t.size2b,t.data11,t.size11],[16008]:[t.data7d,t.size7d,t.data7e,t.size7e,t.data7f,t.size7f,null,null],[16009]:[t.data7d,t.size7d,t.data7e,t.size7e,t.data7f,t.size7f,null,null]},P={bitmaps:t.bitmaps,sounds:t.sounds,modules:t.modules}}catch{const n=await Vt(`./data/${Yt}.js`);console.log("loaded ootw-demo.js"),Ie={[16001]:[n.data17,n.size17,n.data18,n.size18,n.data19,n.size19,null,null],[16002]:[n.data1a,n.size1a,n.data1b,n.size1b,n.data1c,n.size1c,n.data11,n.size11]},P={bitmaps:n.bitmaps,sounds:n.sounds,modules:n.modules}}})();function Zt(){return P!=null&&P.modules?(Object.entries(P.modules).forEach(([,e])=>{const[t,n]=e;e.push(z(t,n))}),!0):!1}function Qt(){return P!=null&&P.sounds?(Object.entries(P.sounds).forEach(([,e])=>{const[t,n]=e;e.push(z(t,n))}),!0):!1}function z(e,t){if(!e)return null;if(e=atob(e),e.length!=t){let s=e.length,r=new Uint8Array(s);for(let a=0;a<s;a++)r[a]=e.charCodeAt(a);let o=Kt(r);return console.assert(o.length==t),o}let n=new Uint8Array(t);for(let s=0;s<e.length;++s)n[s]=e.charCodeAt(s)&255;return n}var Ae=(e=>(e[e.AMIGA=0]="AMIGA",e[e.EGA=1]="EGA",e[e.VGA=2]="VGA",e))(Ae||{});const we=[0,0,0,0,0,170,0,170,0,0,170,170,170,0,0,170,0,170,170,85,0,170,170,170,85,85,85,85,85,255,85,255,85,85,255,255,255,85,85,255,85,255,255,255,85,255,255,255];let ct=new Uint32Array(256*3),ve=new Uint32Array(16*3),le,en=0;function tn(e){le=e}function nn(e){for(let t=0;t<16;++t){let n=le[e+t*2]<<8|le[e+t*2+1];n=(n>>12&15)*3,ve[1*16+t]=4278190080|we[n+2]<<16|we[n+1]<<8|we[n]}}function Ve(e,t){for(let n=0;n<16;++n){const s=le[e+n*2]<<8|le[e+n*2+1];let r=s>>8&15;r=r<<4|r;let o=s>>4&15;o=o<<4|o;let a=s&15;a=a<<4|a,ve[t*16+n]=4278190080|a<<16|o<<8|r}}function sn(e){let t=0;for(let n=0;n<256;++n)ct[n]=4278190080|e[t+2]<<16|e[t+1]<<8|e[t],t+=3}let be=320*2,Pe=200*2,ft;function rn(e,t){let n=ft.getContext("2d"),s=n.getImageData(0,0,be,Pe),r=new Uint32Array(s.data.buffer);for(let o=0;o<be*Pe;++o){const a=e[t+o];a<16?r[o]=ve[en*16+a]:r[o]=ct[a-16]}n.putImageData(s,0,0)}function on(e,t,n,s){ft=e,be=t,Pe=n}var R=(e=>(e[e.RANDOM_SEED=60]="RANDOM_SEED",e[e.LAST_KEYCHAR=218]="LAST_KEYCHAR",e[e.HERO_POS_UP_DOWN=229]="HERO_POS_UP_DOWN",e[e.SCROLL_Y=249]="SCROLL_Y",e[e.HERO_ACTION=250]="HERO_ACTION",e[e.HERO_POS_JUMP_DOWN=251]="HERO_POS_JUMP_DOWN",e[e.HERO_POS_LEFT_RIGHT=252]="HERO_POS_LEFT_RIGHT",e[e.HERO_POS_MASK=253]="HERO_POS_MASK",e[e.HERO_ACTION_POS_MASK=254]="HERO_ACTION_POS_MASK",e[e.PAUSE_SLICES=255]="PAUSE_SLICES",e[e.MUSIC_SYNC=244]="MUSIC_SYNC",e[e.WTF=247]="WTF",e[e.HACK_VAR_54=84]="HACK_VAR_54",e[e.HACK_VAR_67=103]="HACK_VAR_67",e[e.HACK_VAR_DC=220]="HACK_VAR_DC",e[e.HACK_VAR_F7=247]="HACK_VAR_F7",e[e.HACK_VAR_BC=188]="HACK_VAR_BC",e[e.HACK_VAR_F2=242]="HACK_VAR_F2",e[e.HACK_VAR_C6=198]="HACK_VAR_C6",e[e.HACK_VAR_E4=228]="HACK_VAR_E4",e))(R||{});const f=new Array(256),N=new Array(64);var ut=(e=>(e[e.UP=1]="UP",e[e.RIGHT=2]="RIGHT",e[e.DOWN=3]="DOWN",e[e.LEFT=4]="LEFT",e[e.ACTION=5]="ACTION",e[e.JUMP=6]="JUMP",e[e.FF=7]="FF",e))(ut||{});let K=new Array(6),dt=new Array(6);function pe(e){return typeof e=="object"?e.pressed:e===1}function an(){const e=navigator.getGamepads();if(!e)return;const t=e[0];t&&(K[1]=t.axes[1]<-.5,K[3]=t.axes[1]>.5,K[4]=t.axes[0]<-.5,K[2]=t.axes[0]>.5,K[6]=pe(t.buttons[1]),K[5]=pe(t.buttons[0]),K[7]=pe(t.buttons[5])||pe(t.buttons[7]))}function $(e){return dt[e]||K[e]}const qe={" ":5,Enter:5,Shift:6,ArrowUp:1,ArrowDown:3,ArrowLeft:4,ArrowRight:2,f:7};function Ge(e,t){if(e.key in qe){e.preventDefault();const n=qe[e.key];dt[n]=t}}function ln(){document.onkeydown=function(e){Ge(e,1)},document.onkeyup=function(e){Ge(e,0)}}function cn(){let e=0;f[R.HERO_POS_LEFT_RIGHT]=0,f[R.HERO_POS_JUMP_DOWN]=0,f[R.HERO_POS_UP_DOWN]=0,f[R.HERO_ACTION]=0,$(2)?(f[R.HERO_POS_LEFT_RIGHT]=1,e|=1):$(4)&&(f[R.HERO_POS_LEFT_RIGHT]=-1,e|=2),$(3)?(f[R.HERO_POS_UP_DOWN]=1,e|=4):$(1)&&(f[R.HERO_POS_UP_DOWN]=-1,e|=8),$(6)&&(f[R.HERO_POS_JUMP_DOWN]=-1,e|=8),f[R.HERO_POS_MASK]=e,$(5)&&(f[R.HERO_ACTION]=1,e|=128),f[R.HERO_ACTION_POS_MASK]=e}(function(){var e,t=[];function n(o){var a=this,c={},i=-1;this.parameters.forEach(function(m,h){var p=t[++i]||(t[i]=new Float32Array(a.bufferSize));p.fill(m.value),c[h]=p}),this.processor.realm.exec("self.sampleRate=sampleRate="+this.context.sampleRate+";self.currentTime=currentTime="+this.context.currentTime);var l=s(o.inputBuffer),d=s(o.outputBuffer);this.instance.process([l],[d],c)}function s(o){for(var a=[],c=0;c<o.numberOfChannels;c++)a[c]=o.getChannelData(c);return a}function r(o){return o.$$processors||(o.$$processors={})}typeof AudioWorkletNode=="function"&&"audioWorklet"in AudioContext.prototype||(self.AudioWorkletNode=function(o,a,c){var i=r(o)[a],l=o.createScriptProcessor(void 0,2,c&&c.outputChannelCount?c.outputChannelCount[0]:2);if(l.parameters=new Map,i.properties)for(var d=0;d<i.properties.length;d++){var m=i.properties[d],h=o.createGain().gain;h.value=m.defaultValue,l.parameters.set(m.name,h)}var p=new MessageChannel;e=p.port2;var v=new i.Processor(c||{});return e=null,l.port=p.port1,l.processor=i,l.instance=v,l.onaudioprocess=n,l},Object.defineProperty((self.AudioContext||self.webkitAudioContext).prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new self.AudioWorklet(this))}}),self.AudioWorklet=function(){function o(a){this.$$context=a}return o.prototype.addModule=function(a,c){var i=this;return fetch(a).then(function(l){if(!l.ok)throw Error(l.status);return l.text()}).then(function(l){var d={sampleRate:i.$$context.sampleRate,currentTime:i.$$context.currentTime,AudioWorkletProcessor:function(){this.port=e},registerProcessor:function(h,p){r(i.$$context)[h]={realm:m,context:d,Processor:p,properties:p.parameterDescriptors||[]}}};d.self=d;var m=new function(h,p){var v=document.createElement("iframe");v.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",p.appendChild(v);var b=v.contentWindow,_=b.document,C="var window,$hook";for(var k in b)k in h||k==="eval"||(C+=",",C+=k);for(var T in h)C+=",",C+=T,C+="=self.",C+=T;var U=_.createElement("script");U.appendChild(_.createTextNode(`function $hook(self,console) {"use strict";
        `+C+";return function() {return eval(arguments[0])}}")),_.body.appendChild(U),this.exec=b.$hook.call(h,h,console)}(d,document.documentElement);return m.exec((c&&c.transpile||String)(l)),null})},o}())})();const Ye=()=>({orderTable:new Array(128),curOrder:0,numOrder:0,curPos:0,data:null,samples:new Array(15).fill(null).map(()=>({data:null,volume:0}))}),fn=()=>({sample:null,volume:0,loops:0,loop:0});function Y(e,t){return e[t]<<8|e[t+1]}class un{constructor(){this._delay=0,this._resNum=0,this._sfxMod=Ye(),this._rate=0,this._channels=new Array(4).fill(null),this._modifyVarCallback=null,this._audioContext=new window.AudioContext,this.resumeAudio()}setModifyVarCallback(t){this._modifyVarCallback=t}async init(){await this.initAudio(),this.initEvents()}async initAudio(){try{this._rate=this._audioContext.sampleRate,await this._audioContext.audioWorklet.addModule("assets/processors.js"),this._sfxRawWorklet=new AudioWorkletNode(this._audioContext,"sfxraw-processor",{outputChannelCount:[1],numberOfInputs:0,numberOfOutputs:1}),this._sfxRawWorklet.port.onmessage=this.onSFXRawProcessorMessage.bind(this),this._sfxRawWorklet.port.start(),this._sfxPlayerWorklet=new AudioWorkletNode(this._audioContext,"sfxplayer-processor",{outputChannelCount:[2],numberOfInputs:0,numberOfOutputs:1}),this._sfxPlayerWorklet.port.onmessage=this.onSFXPlayerProcessorMessage.bind(this),this._sfxPlayerWorklet.port.start(),this._sfxRawWorklet.connect(this._audioContext.destination),this._sfxPlayerWorklet.connect(this._audioContext.destination),this.postMessageToSFXPlayerProcessor({message:"init",mixingRate:this._rate}),this.postMessageToSFXRawProcessor({message:"init",mixingRate:this._rate})}catch(t){console.error(`Error during initAudio: ${t} ${t.stack}`)}}initEvents(){document.addEventListener("click",()=>this.resumeAudio())}resumeAudio(){this._audioContext&&this._audioContext.state==="suspended"&&this._audioContext.resume()}setEventsDelay(t,n=!1){this._delay=t*60/7050>>0,n&&this.postMessageToSFXPlayerProcessor({message:"setEventsDelay",delay:this._delay})}onSFXPlayerProcessorMessage(t){const n=t.data;switch(n.message){case"syncVar":const{variable:s,value:r}=n;this._modifyVarCallback(s,r);break}}onSFXRawProcessorMessage(t){}postMessageToSFXPlayerProcessor(t){this._sfxPlayerWorklet?this._sfxPlayerWorklet.port.postMessage(t):console.warn("Cannot send message to sfx player processor: not available")}postMessageToSFXRawProcessor(t){this._sfxRawWorklet?this._sfxRawWorklet.port.postMessage(t):console.warn("Cannot send message to raw player processor: not available")}loadSfxModule(t,n,s,r){const[,,o]=r.modules[t];if(o){this._resNum=t,this._sfxMod=Ye(),this._sfxMod.curOrder=s,this._sfxMod.numOrder=Y(o,62);for(let a=0;a<128;++a)this._sfxMod.orderTable[a]=o[64+a];n===0&&(n=Y(o,0)),this.setEventsDelay(n),this._sfxMod.data=new Uint8Array(o.buffer,192),this.prepareInstruments(new Uint8Array(o.buffer,2),r.sounds),this.postMessageToSFXPlayerProcessor({message:"load",sfxMod:this._sfxMod,delay:this._delay})}else debugger}prepareInstruments(t,n){let s=0;for(let r=0;r<15;++r){const o=this._sfxMod.samples[r],a=Y(t,s);if(s+=2,a!==0){o.volume=Y(t,s);const c=n[a];c&&c[2]?o.data=c[2]:console.error(`Error loading instrument 0x${a.toString(16)}`)}s+=2}}startMusic(){this.postMessageToSFXPlayerProcessor({message:"start"})}stopMusic(){this.postMessageToSFXPlayerProcessor({message:"stop"})}playMusic(){this.stopMusic(),this.postMessageToSFXPlayerProcessor({message:"play",mixingRate:this._rate})}pause(){this.postMessageToSFXRawProcessor({message:"pause"}),this.postMessageToSFXPlayerProcessor({message:"pause"})}resume(){this.postMessageToSFXRawProcessor({message:"resume"}),this.postMessageToSFXPlayerProcessor({message:"resume"})}playSoundRaw(t,n,s,r){let o=Y(n,0)*2;const a=Y(n,2)*2;a!==0&&(o=a);const c=new Int8Array(n.buffer,8,o||n.byteLength-8);if(c){const i=fn();i.loops=a!==0?-1:0,i.volume=r,i.freq=s,i.sample=c,this.postMessageToSFXRawProcessor({message:"play",sound:i,channel:t})}}stopSoundChannel(t){this.postMessageToSFXRawProcessor({message:"stop",channel:t})}}const dn=[3327,3523,3729,3951,4182,4430,4697,4972,5279,5593,5926,6280,6653,7046,7457,7902,8363,8860,9395,9943,10559,11186,11852,12560,13307,14093,14915,15839,16727,17720,18840,19886,21056,22372,23706,25032,26515,28185,29829,31677];let S;async function pn(){S=new un,await S.init(),Qt()||(console.log("error loading sounds"),S=null),Zt()}function hn(e,t,n){S!==null&&(e!==0?(S.loadSfxModule(e,t,n,P),S.startMusic(),S.playMusic()):t!==0?S.setEventsDelay(t,!0):S.stopMusic())}function mn(e,t,n,s){if(S!==null){if(n===0){S.stopSoundChannel(s);return}n>63&&(n=63);try{if(P.sounds&&P.sounds[e]){const[,,r]=P.sounds[e];r&&(t>=40&&console.error("Assertion failed: $({freq} < 40"),S.playSoundRaw(s&3,r,dn[t],n))}}catch{console.error(`Could not play raw sound ${e}`);debugger}}}var E=(e=>(e[e.movConst=0]="movConst",e[e.mov=1]="mov",e[e.add=2]="add",e[e.addConst=3]="addConst",e[e.call=4]="call",e[e.ret=5]="ret",e[e.pauseThread=6]="pauseThread",e[e.jmp=7]="jmp",e[e.setSetVect=8]="setSetVect",e[e.jnz=9]="jnz",e[e.condJmp=10]="condJmp",e[e.setPalette=11]="setPalette",e[e.resetThread=12]="resetThread",e[e.selectVideoPage=13]="selectVideoPage",e[e.fillVideoPage=14]="fillVideoPage",e[e.copyVideoPage=15]="copyVideoPage",e[e.blitFramebuffer=16]="blitFramebuffer",e[e.killThread=17]="killThread",e[e.drawString=18]="drawString",e[e.sub=19]="sub",e[e.and=20]="and",e[e.or=21]="or",e[e.shl=22]="shl",e[e.shr=23]="shr",e[e.playSound=24]="playSound",e[e.updateMemList=25]="updateMemList",e[e.playMusic=26]="playMusic",e))(E||{});const Sn=128,En=64,vn=!0;let Tn=Fe.EN;const x=3,A=320*x,ee=200*x,O=A*ee,gn=50;let y=new Uint8Array(4*O),ce,Z,me,oe=-1,He,xe,pt,I,Oe,Se,W,Le=0,se;function u(){const e=He[I];return I+=1,e}function _n(e,t){return e[t]<<8|e[t+1]}function w(){const e=_n(He,I);return I+=2,e}function J(e,t){const n=1<<t-1;return e-((e&n)<<1)}function Rn(){for(;!Se;){const e=u();if(e&Sn){const t=(e<<8|u())<<1&65534;let n=u(),s=u(),r=s-199;r>0&&(s=199,n+=r),ke(xe,t,255,64,n,s)}else if(e&En){const t=w()<<1&65534;let n=u();(e&32)==0?(e&16)==0?n=n<<8|u():n=f[n]:e&16&&(n+=256);let s=u();(e&8)==0&&((e&4)==0?s=s<<8|u():s=f[s]);let r=xe,o=64;(e&2)==0?e&1&&(o=f[u()]):e&1?r=pt:o=u(),ke(r,t,255,o,n,s)}else console.assert(e<=26),Ze[e]?Ze[e]():console.log(`opcode ${e} not implemented`)}}function yn(){W!=0&&(ht(W),Le=W,W=0);for(let e=0;e<N.length;++e){N[e].state=N[e].next_state;const t=N[e].next_offset;t!=-1&&(N[e].offset=t==-2?-1:t,N[e].next_offset=-1)}an(),cn();for(let e=0;e<N.length;++e)if(N[e].state==0){const t=N[e].offset;t!=-1&&(I=t,N[e].stack.length=0,Oe=e,Se=!1,Rn(),N[e].offset=I)}}function ht(e,t=0){const n=Ie[e];if(!n)throw"Part not found: "+e;tn(z(n[0],n[1])),He=z(n[2],n[3]),xe=z(n[4],n[5]),pt=z(n[6],n[7]);for(let s=0;s<N.length;++s)N[s]={state:0,next_state:0,offset:-1,next_offset:-1,stack:[]};N[0].offset=0,f[0]=t}function j(e){return e==255?me:e==254?Z:(console.assert(e<4),e)}function Nn(e,t){e=j(e),y.fill(t,e*O,(e+1)*O)}function wn(e,t,n){if(t=j(t),e>=254)e=j(e),y.set(y.subarray(e*O,(e+1)*O),t*O);else{if((e&128)==0&&(n=0),e=j(e&3),t==e)return;const s=t*O,r=e*O;if(n==0)y.set(y.subarray(r,r+O),s);else if(n*=x,n>-A&&n<A){const o=n*A;n<0?y.set(y.subarray(r-o,r+O),s):y.set(y.subarray(r,r+O-o),s+o)}}}function Cn(e,t,n,s){if(n<0||n>=A||s<0||s>=ee)return;const r=e*O+s*A+n;t==17?(console.assert(e!=0),y[r]=y[s*A+n]):t==16?y[r]|=8:(console.assert(t<16),y[r]=t)}function In(e,t,n,s,r){if(s>r){const a=s;s=r,r=a}if(s>=A||r<0)return;s<0&&(s=0),r>=A&&(r=A-1);const o=e*O+n*A;if(t==17)console.assert(e!=0),y.set(y.subarray(n*A+s,n*A+r+1),o+s);else if(t==16)for(let a=s;a<=r;++a)y[o+a]|=8;else console.assert(t<16),y.fill(t,o+s,o+r+1)}function An(e,t,n){let s=0,r=n.length-1,o=Math.min(n[s].y,n[r].y),a=n[s++].x<<16,c=n[r--].x<<16,i=n.length;for(i-=2;i!=0;i-=2){const l=n[r].y-n[r+1].y,d=(n[r].x-n[r+1].x<<16)/(l==0?1:l)>>0;r-=1;const m=n[s].y-n[s-1].y,h=(n[s].x-n[s-1].x<<16)/(m==0?1:m)>>0;if(s+=1,c=c&4294901760|32767,a=a&4294901760|32768,m==0)c+=d,a+=h;else for(let p=0;p<m;++p)if(o>=0&&In(e,t,o,c>>16,a>>16),c+=d,a+=h,o+=1,o>=ee)return}}function bn(e,t,n,s,r,o){const a=e[t++]*s/64>>0,c=e[t++]*s/64>>0,i=r*x-a*x/2>>0,l=r*x+a*x/2>>0,d=o*x-c*x/2>>0,m=o*x+c*x/2>>0;if(i>=A||l<0||d>=ee||m<0)return;const h=e[t++];console.assert((h&1)==0);let p=new Array;for(let v=0;v<h;++v){const b=i+(e[t++]*s/64>>0)*x,_=d+(e[t++]*s/64>>0)*x;p.push({x:b,y:_})}h==4&&a==0&&c<=1?Cn(ce,n,i,d):An(ce,n,p)}function Pn(e,t,n,s,r){const o=s-e[t++]*n/64>>0,a=r-e[t++]*n/64>>0,c=e[t++];for(let i=0;i<=c;++i){const l=e[t]<<8|e[t+1];t+=2;const d=o+e[t++]*n/64>>0,m=a+e[t++]*n/64>>0;let h=255;l&32768&&(h=e[t]&127,t+=2),ke(e,l<<1&65534,h,n,d,m)}}function ke(e,t,n,s,r,o){const a=e[t++];a>=192?(n&128&&(n=a&63),bn(e,t,n,s,r,o)):(a&63)==2&&Pn(e,t,s,r,o)}function mt(e,t,n,s){let r=e*O+(n*A+t)*x;for(let o=0;o<x;++o)y.fill(s,r,r+x),r+=A}function xn(e,t,n,s,r){if(s<320/8&&r<200-8)for(let o=0;o<8;++o){const a=jt[(t-32)*8+o];for(let c=0;c<8;++c)(a&1<<7-c)!=0&&mt(e,s*8+c,r+o,n)}}function On(e,t,n,s){let r=Xt;if(Tn==Fe.FR&&e in je&&(r=je),e in r){const o=r[e];kn(o,t,n,s)}}function kn(e,t,n,s){const r=n;for(let o=0;o<e.length;++o){const a=e.charCodeAt(o);a==10?(s+=8,n=r):(xn(ce,a,t,n,s),n+=1)}}function Mn(e){const t=P.bitmaps[e],n=t[1];console.assert(n==32e3);const s=z(t[0],n);let r=0;for(let o=0;o<200;++o)for(let a=0;a<320;a+=8){for(let c=0;c<8;++c){const i=1<<7-c;let l=0;for(let d=0;d<4;++d)s[r+d*8e3]&i&&(l|=1<<d);mt(0,a+c,o,l)}r+=1}}function Fn(e){if(e!=254)if(e==255){const t=Z;Z=me,me=t}else Z=j(e);if(oe!=-1){const t=oe*32;Ve(t,Ae.AMIGA),nn(t+1024),Ve(t+1024,Ae.VGA),oe=-1}rn(y,Z*O)}const Ze={[E.movConst](){const e=u(),t=J(w(),16);f[e]=t},[E.mov](){const e=u(),t=u();f[e]=f[t]},[E.add](){const e=u(),t=u();f[e]+=f[t]},[E.addConst](){const e=u(),t=J(w(),16);f[e]+=t},[E.call](){const e=w();N[Oe].stack.push(I),I=e},[E.ret](){I=N[Oe].stack.pop()},[E.pauseThread](){Se=!0},[E.jmp](){I=w()},[E.setSetVect](){const e=u(),t=w();N[e].next_offset=t},[E.jnz](){const e=u();f[e]-=1;const t=w();f[e]!=0&&(I=t)},[E.condJmp](){const e=u(),t=f[u()];let n;e&128?n=f[u()]:e&64?n=J(w(),16):n=u();const s=w();switch(e&7){case 0:t==n&&(I=s);break;case 1:t!=n&&(I=s);break;case 2:t>n&&(I=s);break;case 3:t>=n&&(I=s);break;case 4:t<n&&(I=s);break;case 5:t<=n&&(I=s);break}},[E.setPalette](){oe=w()>>8},[E.resetThread](){const e=u(),t=u(),n=u();if(n==2)for(let s=e;s<=t;++s)N[s].next_offset=-2;else{console.assert(n==0||n==1);for(let s=e;s<=t;++s)N[s].next_state=n}},[E.selectVideoPage](){const e=u();ce=j(e)},[E.fillVideoPage](){const e=u(),t=u();Nn(e,t)},[E.copyVideoPage](){const e=u(),t=u();wn(e,t,f[R.SCROLL_Y])},[E.blitFramebuffer](){const e=u();if(!$(ut.FF)&&f[R.PAUSE_SLICES]!==0){const n=Date.now()-se,s=f[R.PAUSE_SLICES]*1e3/gn-n;if(s>0){const r=se+s;for(;se<r;)se=Date.now()}}se=Date.now(),f[R.WTF]=0,Fn(e)},[E.killThread](){I=-1,Se=!0},[E.drawString](){const e=w(),t=u(),n=u(),s=u();On(e,s,t,n)},[E.sub](){const e=u(),t=u();f[e]-=f[t]},[E.and](){const e=u(),t=w();f[e]=J(f[e]&t&65535,16)},[E.or](){const e=u(),t=w();f[e]=J((f[e]|t)&65535,16)},[E.shl](){const e=u(),t=w()&15;f[e]=J(f[e]<<t&65535,16)},[E.shr](){const e=u(),t=w()&15;f[e]=J((f[e]&65535)>>t,16)},[E.playSound](){const e=w(),t=u(),n=u(),s=u();mn(e,t,n,s)},[E.updateMemList](){const e=w();if(e>ie.PROTECTION)W=e;else if(e in P.bitmaps)if(e>=3e3){const t=P.bitmaps[e];sn(z(t[0],256*3)),y.set(z(t[1],A*ee))}else Mn(e)},[E.playMusic](){const e=w(),t=w(),n=u();hn(e,t,n)}};function St(){return{part:Le,vars:f.slice(),tasks:JSON.parse(JSON.stringify(N)),buffer8:y.slice(),palette32:ve.slice()}}function Et(){me=1,Z=2,ce=j(254),y.fill(0),oe=-1,f.fill(0),f[R.RANDOM_SEED]=Date.now(),f[R.HACK_VAR_BC]=16,f[R.HACK_VAR_C6]=128,f[R.HACK_VAR_F2]=4e3,f[R.HACK_VAR_DC]=33,f[R.HACK_VAR_E4]=20,W=lt||vn?ie.INTRODUCTION:ie.PROTECTION,S==null||S.stopMusic()}function Qe(e,t=0){W=e,ht(W,t),Le=W,W=0}async function Hn(e){on(e,A,ee),await pn(),S==null||S.setModifyVarCallback((t,n)=>{f[t]=n}),ln(),Et()}var Ln=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},vt={exports:{}};(function(e,t){(function(n,s){e.exports=s()})(Ln,function(){var n=function(){function s(p){return a.appendChild(p.dom),p}function r(p){for(var v=0;v<a.children.length;v++)a.children[v].style.display=v===p?"block":"none";o=p}var o=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(p){p.preventDefault(),r(++o%a.children.length)},!1);var c=(performance||Date).now(),i=c,l=0,d=s(new n.Panel("FPS","#0ff","#002")),m=s(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=s(new n.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:a,addPanel:s,showPanel:r,begin:function(){c=(performance||Date).now()},end:function(){l++;var p=(performance||Date).now();if(m.update(p-c,200),p>i+1e3&&(d.update(1e3*l/(p-i),100),i=p,l=0,h)){var v=performance.memory;h.update(v.usedJSHeapSize/1048576,v.jsHeapSizeLimit/1048576)}return p},update:function(){c=this.end()},domElement:a,setMode:r}};return n.Panel=function(s,r,o){var a=1/0,c=0,i=Math.round,l=i(window.devicePixelRatio||1),d=80*l,m=48*l,h=3*l,p=2*l,v=3*l,b=15*l,_=74*l,C=30*l,k=document.createElement("canvas");k.width=d,k.height=m,k.style.cssText="width:80px;height:48px";var T=k.getContext("2d");return T.font="bold "+9*l+"px Helvetica,Arial,sans-serif",T.textBaseline="top",T.fillStyle=o,T.fillRect(0,0,d,m),T.fillStyle=r,T.fillText(s,h,p),T.fillRect(v,b,_,C),T.fillStyle=o,T.globalAlpha=.9,T.fillRect(v,b,_,C),{dom:k,update:function(U,ue){a=Math.min(a,U),c=Math.max(c,U),T.fillStyle=o,T.globalAlpha=1,T.fillRect(0,0,d,b),T.fillStyle=r,T.fillText(i(U)+" "+s+" ("+i(a)+"-"+i(c)+")",h,p),T.drawImage(k,v+l,b,_-l,C,v,b,_-l,C),T.fillRect(v+_-l,b,l,C),T.fillStyle=o,T.globalAlpha=.9,T.fillRect(v+_-l,b,l,i((1-U/ue)*C))}}},n})})(vt);var Un=vt.exports;let Q,V=null;const ae=new Array;let Ee;const Wn=50,zn=1e3;let he=null;function Ue(){const e=Date.now();Q.begin(),yn(),Q.end(),Ee+zn<e&&(ae.length==Wn&&ae.shift(),ae.push(St()),Ee=Date.now()),V=requestAnimationFrame(Ue)}function Dn(){Q=new Un,Q.showPanel(1),document.body.appendChild(Q.dom),Ee=Date.now(),ae.length=0,Ue()}function Bn(){return V&&cancelAnimationFrame(V),Q.dom.remove(),V=null,S==null||S.pause(),!0}function Kn(){return V?(cancelAnimationFrame(V),V=null,S==null||S.pause(),!0):(S==null||S.resume(),Ue(),!1)}function Jn(){if(he)Qe(he),he=null;else{S==null||S.pause();const{part:e}=St();he=e,Qe(ie.CODE)}}function $n(){Et(),Ee=Date.now(),ae.length=0}var Xn=Object.defineProperty,jn=Object.getOwnPropertyDescriptor,Vn=(e,t,n,s)=>{for(var r=s>1?void 0:s?jn(t,n):t,o=e.length-1,a;o>=0;o--)(a=e[o])&&(r=(s?a(t,n,r):a(r))||r);return s&&r&&Xn(t,n,r),r};let et=class extends yt{constructor(){super(...arguments);this.onKeypress=e=>{switch(e.key){case"r":$n();break;case"p":Kn();break;case"c":Jn();break}}}createRenderRoot(){return this}firstUpdated(){this.onStart()}connectedCallback(){super.connectedCallback(),document.addEventListener("keyup",this.onKeypress)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keyup",this.onKeypress),this.onStop()}render(){return Nt`
      <div id="app-index__canvas-container">
        <canvas id="screen" width="960" height="600"></canvas>
      </div>
    `}async onStart(){const e=this.querySelector("#screen");await Hn(e),Dn()}onStop(){Bn(),wt.go("")}};et=Vn([Ct("app-game")],et);export{et as AppGame};
//# sourceMappingURL=app-game.61cc8a98.js.map
